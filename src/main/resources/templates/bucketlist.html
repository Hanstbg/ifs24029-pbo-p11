<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Bucket List - WorldPass</title>
    <!-- Dependencies -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,500;0,700;1,400&family=Plus+Jakarta+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-deep: #020617;
            --bg-card: #0f172a;
            --bg-input: #1e293b;
            --accent-blue: #38bdf8;
            --accent-gold: #fbbf24;
            --text-main: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
        }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: 'Plus Jakarta Sans', sans-serif;
            min-height: 100vh;
            background-image: radial-gradient(circle at top center, #1e293b 0%, #020617 70%);
        }
        
        .serif-font { font-family: 'Playfair Display', serif; letter-spacing: 0.5px; }

        /* Navbar & Dropdown Language */
        .simple-nav {
            padding: 20px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
            background: rgba(2, 6, 23, 0.9); backdrop-filter: blur(10px);
        }
        .lang-btn {
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); 
            color: var(--text-secondary); border-radius: 20px; padding: 5px 15px; font-size: 0.85rem;
        }
        .lang-btn:hover { background: rgba(56, 189, 248, 0.1); color: var(--accent-blue); border-color: var(--accent-blue); }
        .dropdown-menu-dark-custom {
            background-color: var(--bg-card); border: 1px solid rgba(56, 189, 248, 0.2);
        }

        /* Typography */
        .page-subtitle { font-size: 11px; letter-spacing: 4px; font-weight: 700; color: var(--accent-gold); text-transform: uppercase; }
        .page-title { font-size: 3.5rem; font-weight: 700; color: var(--text-main); text-shadow: 0 4px 20px rgba(0,0,0,0.5); }

        /* Inputs */
        .bucket-input {
            background: var(--bg-input); border: 1px solid rgba(255,255,255,0.1);
            color: white; padding: 16px 20px; border-radius: 12px; font-size: 1rem;
        }
        .bucket-input:focus {
            background: #25334d; border-color: var(--accent-blue); color: white; outline: none; box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.1);
        }
        
        /* Dark Mode Date Picker Fix */
        input[type="date"] { color-scheme: dark; }

        /* Card Items */
        .bucket-card {
            background: var(--bg-card); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 16px; transition: all 0.3s ease; position: relative; overflow: hidden;
        }
        .bucket-card:hover { transform: translateY(-2px); border-color: rgba(56, 189, 248, 0.4); background: #162036; }
        
        .dest-title { font-size: 1.25rem; font-weight: 600; color: var(--text-main); }
        .dest-notes { color: var(--text-secondary); font-size: 0.95rem; font-weight: 300; }
        
        /* Date Badge Style */
        .date-badge {
            font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; font-weight: 600;
            color: var(--accent-blue); background: rgba(56, 189, 248, 0.1);
            padding: 4px 10px; border-radius: 6px; display: inline-block; margin-bottom: 8px;
        }

        /* Check Button */
        .btn-check-custom {
            width: 42px; height: 42px; border-radius: 12px; border: 2px solid #334155;
            display: flex; align-items: center; justify-content: center; color: transparent; transition: 0.3s;
        }
        .btn-check-custom:hover { border-color: var(--accent-blue); color: var(--accent-blue); background: rgba(56, 189, 248, 0.1); }

        /* Achieved State */
        .achieved { border-color: rgba(56, 189, 248, 0.1); background: rgba(15, 23, 42, 0.6); }
        .achieved .dest-title, .achieved .dest-notes, .achieved .date-badge { 
            text-decoration: line-through; opacity: 0.4; color: var(--text-muted); 
        }
        .achieved .btn-check-custom {
            border-color: var(--accent-blue); background: var(--accent-blue); color: var(--bg-deep);
            box-shadow: 0 0 15px rgba(56, 189, 248, 0.4);
        }

        .btn-add {
            background: var(--text-main); color: var(--bg-deep); border: none; font-weight: 700;
            border-radius: 12px; transition: 0.3s;
        }
        .btn-add:hover { background: var(--accent-blue); color: white; }

        .empty-state { text-align: center; padding: 60px 0; opacity: 0.6; }
    </style>
</head>
<body>

    <!-- Nav -->
    <nav class="simple-nav sticky-top">
        <div class="container d-flex justify-content-between align-items-center">
            <h4 class="m-0 serif-font fw-bold text-white">WorldPass <span style="color: var(--accent-blue)">List</span></h4>
            
            <div class="d-flex align-items-center gap-3">
                <!-- Language Switcher -->
                <div class="dropdown">
                    <button class="btn lang-btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-globe me-1"></i> <span id="currentLangLabel">EN</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-dark-custom dropdown-menu-end">
                        <li><a class="dropdown-item" href="#" onclick="setLanguage('en')">üá∫üá∏ English</a></li>
                        <li><a class="dropdown-item" href="#" onclick="setLanguage('id')">üáÆüá© Indonesia</a></li>
                        <li><a class="dropdown-item" href="#" onclick="setLanguage('jp')">üáØüáµ Êó•Êú¨Ë™û</a></li>
                    </ul>
                </div>

                <a href="/dashboard" class="btn btn-sm btn-outline-secondary text-white rounded-pill px-4 border-secondary border-opacity-25" data-lang="back_btn">
                    <i class="fas fa-arrow-left me-2 small"></i> Back to Dashboard
                </a>
            </div>
        </div>
    </nav>

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-7 col-md-9">
                
                <!-- Header -->
                <div class="text-center mb-5">
                    <h6 class="page-subtitle mb-2" data-lang="subtitle">Future Destinations</h6>
                    <h1 class="serif-font page-title" data-lang="title">Where to Next?</h1>
                    <p class="text-secondary mt-2 fw-light fs-5" data-lang="desc">Dream it, list it, and one day, live it.</p>
                </div>

                <!-- Input Form -->
                <div class="card p-2 mb-5 shadow-lg border-0" style="background: var(--bg-card); border-radius: 20px; border: 1px solid rgba(255,255,255,0.08);">
                    <form action="/bucketlist/add" method="post" class="row g-2 p-2">
                        <!-- Destination Input -->
                        <div class="col-md-5">
                            <input type="text" name="destination" class="form-control bucket-input" data-placeholder="ph_dest" placeholder="e.g. Northern Lights, Norway" required>
                        </div>
                        
                        <!-- Date Input (BARU) -->
                        <div class="col-md-3">
                            <input type="date" name="targetDate" class="form-control bucket-input" style="font-size: 0.9rem;" title="Target Date">
                        </div>

                        <!-- Notes Input -->
                        <div class="col-md-3">
                            <input type="text" name="notes" class="form-control bucket-input" data-placeholder="ph_notes" placeholder="Notes (Optional)">
                        </div>

                        <!-- Button -->
                        <div class="col-md-1">
                            <button type="submit" class="btn btn-add w-100 h-100 d-flex align-items-center justify-content-center">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- List Items -->
                <div class="d-flex flex-column gap-3">
                    
                    <div th:each="item : ${bucketList}" 
                         th:class="${item.isAchieved} ? 'card bucket-card p-4 achieved' : 'card bucket-card p-4'">
                        
                        <div class="d-flex align-items-center gap-4">
                            <!-- Toggle Button -->
                            <a th:href="@{'/bucketlist/toggle/' + ${item.id}}" class="btn-check-custom text-decoration-none flex-shrink-0">
                                <i class="fas fa-check"></i>
                            </a>
                            
                            <!-- Content -->
                            <div class="flex-grow-1">
                                <!-- Date Display (BARU) -->
                                <div th:if="${item.targetDate != null}" class="date-badge">
                                    <i class="far fa-calendar-alt me-1"></i>
                                    <span th:text="${#temporals.format(item.targetDate, 'dd MMMM yyyy')}">12 Oct 2025</span>
                                </div>
                                
                                <h5 class="m-0 serif-font dest-title" th:text="${item.destination}">Destination Name</h5>
                                
                                <div class="mt-1 dest-notes" th:if="${item.notes != null && !item.notes.isEmpty()}">
                                    <i class="fas fa-quote-left me-2 opacity-50 small"></i>
                                    <span th:text="${item.notes}">Notes description here...</span>
                                </div>
                            </div>

                            <!-- Delete Button -->
                            <a th:href="@{'/bucketlist/delete/' + ${item.id}}" class="btn btn-link text-danger opacity-25 hover-opacity-100 p-0" style="transition: 0.3s;" onclick="return confirm('Remove from bucket list?')">
                                <i class="fas fa-times fa-lg"></i>
                            </a>
                        </div>
                    </div>

                    <!-- Empty State -->
                    <div th:if="${#lists.isEmpty(bucketList)}" class="empty-state">
                        <i class="fas fa-map-location-dot fa-3x mb-3 text-secondary"></i>
                        <p class="text-secondary" data-lang="empty_state">Your bucket list is empty.<br>Start adding your dream destinations above.</p>
                    </div>

                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- LANGUAGE SCRIPT -->
    <script>
        // 1. Kamus Bahasa
        const translations = {
            en: {
                subtitle: "Future Destinations",
                title: "Where to Next?",
                desc: "Dream it, list it, and one day, live it.",
                back_btn: "<i class='fas fa-arrow-left me-2 small'></i> Back to Dashboard",
                ph_dest: "e.g. Northern Lights, Norway",
                ph_notes: "Notes (Optional)",
                empty_state: "Your bucket list is empty.<br>Start adding your dream destinations above."
            },
            id: {
                subtitle: "Destinasi Masa Depan",
                title: "Kemana Selanjutnya?",
                desc: "Impikan, catat, dan suatu hari, wujudkan.",
                back_btn: "<i class='fas fa-arrow-left me-2 small'></i> Kembali ke Dashboard",
                ph_dest: "Cth. Raja Ampat, Indonesia",
                ph_notes: "Catatan (Opsional)",
                empty_state: "Daftar impianmu masih kosong.<br>Mulai tambahkan destinasi impianmu di atas."
            },
            jp: {
                subtitle: "Â∞ÜÊù•„ÅÆÁõÆÁöÑÂú∞",
                title: "Ê¨°„ÅØ„Å©„Åì„Å∏Ôºü",
                desc: "Â§¢Ë¶ã„Å¶„ÄÅÊõ∏„ÅçÁïô„ÇÅ„Å¶„ÄÅ„ÅÑ„Å§„ÅãÂÆüÁèæ„Åó„Çà„ÅÜ„ÄÇ",
                back_btn: "<i class='fas fa-arrow-left me-2 small'></i> „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Å´Êàª„Çã",
                ph_dest: "‰æãÔºö„Ç™„Éº„É≠„É©„ÄÅ„Éé„É´„Ç¶„Çß„Éº",
                ph_notes: "„É°„É¢Ôºà‰ªªÊÑèÔºâ",
                empty_state: "„Éê„Ç±„ÉÉ„Éà„É™„Çπ„Éà„ÅØÁ©∫„Åß„Åô„ÄÇ<br>‰∏ä„ÅÆ„Éï„Ç©„Éº„É†„Åã„ÇâÂ§¢„ÅÆÁõÆÁöÑÂú∞„ÇíËøΩÂä†„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ"
            }
        };

        // 2. Fungsi Set Bahasa
        function setLanguage(lang) {
            // Simpan ke localStorage agar sinkron dengan Dashboard
            localStorage.setItem('worldpass_lang', lang);
            
            // Update Label Dropdown
            document.getElementById('currentLangLabel').innerText = lang.toUpperCase();

            // Update Teks Biasa (innerHTML untuk support icon)
            const elements = document.querySelectorAll('[data-lang]');
            elements.forEach(el => {
                const key = el.getAttribute('data-lang');
                if (translations[lang][key]) {
                    el.style.opacity = 0; 
                    setTimeout(() => { 
                        el.innerHTML = translations[lang][key]; 
                        el.style.opacity = 1; 
                    }, 200);
                }
            });

            // Update Placeholder Input
            const inputs = document.querySelectorAll('[data-placeholder]');
            inputs.forEach(el => {
                const key = el.getAttribute('data-placeholder');
                if (translations[lang][key]) {
                    el.placeholder = translations[lang][key];
                }
            });
        }

        // 3. Jalankan saat Load
        document.addEventListener('DOMContentLoaded', () => {
            // Ambil bahasa dari Dashboard, default 'en'
            const savedLang = localStorage.getItem('worldpass_lang') || 'en';
            setLanguage(savedLang);

            // Transisi halus
            const transElements = document.querySelectorAll('[data-lang]');
            transElements.forEach(el => el.style.transition = "opacity 0.3s ease");
        });

        // Hover Effect untuk Delete
        const deleteBtns = document.querySelectorAll('.text-danger');
        deleteBtns.forEach(btn => {
            btn.addEventListener('mouseenter', () => btn.style.opacity = '1');
            btn.addEventListener('mouseleave', () => btn.style.opacity = '0.25');
        });
    </script>
</body>
</html>